# 设计模式

## 前端常用的设计模式有哪些？使用的场景有哪些？

最重要的思想是开闭（开放封闭）原则，对扩展开放，对修改封闭。

1. 工厂模式：用一个工厂函数来创建实例，隐藏 new；场景：jQuery 的$函数，React 中的 createElement 函数等
2. 单例模式：全局唯一的实例，如 Vuex Redux 中的 store，全局唯一的 dialog modal 等

   ```js
   // 单例模式
   class SingleTon {
     private static instance: Single | null = null;
     private constructor(){}
     public static getInstance(): SingleTon {
        if(this.instance == null) {
            this.instance = new SingleTon();
        }
        return this.instance;
     }
     fn1(){}
     fn2(){}
   }

   const s = SingleTon.getInstance();
   s.fn1();

   const s1 = SingleTon.getInstance();

   console.log(s === s1); // true
   ```

3. 代理模式： 使用者不能直接访问对象，而是访问一个代理层，在代理层可以监听 get、set 做很多事情；如 ES6 Proxy 实现 Vue3 响应式。
4. 观察者模式：一个主题，一个观察者，主题变化之后触发观察者执行；如 DOM 事件监听等。
5. 发布订阅模式：`event.on('event-key', ()=>{})`, `event.emit('event-key')`;
6. 装饰器模式：原功能不变，增加一些新功能(AOP 面向切面编程)；场景：ES6 和 TypeScript 里的 Decorator 语法、类装饰器、方法装饰器等。

### 观察者模式和发布订阅模式的区别

观察者模式：  
Subject 和 Observer 直接绑定，没有中间媒介；  
如 addEventListener 绑定事件；

发布订阅模式：  
Publisher 和 Observer 互不认识，需要中间媒介 Event channel；  
如 EventBus 自定义事件；

![观察者模式和发布订阅模式的区别](./img/观察者模式和发布订阅模式的区别.png)
