# 代码题目

## JS 创建 10 个\<a>标签，点击的时候弹出对应的序号

```js
let a;

// 解题的关键在这块去声明变量i，使它处于一个块级作用域，如果放在for外面，则每个a标签点击后一直输出10
for (let i = 0; i < 10; i++) {
  a = document.createElement('a');
  a.innerHTML = i + '<br>';
  a.addEventListener('click', function (e) {
    e.preventDefault();
    console.log(i);
  });

  document.body.appendChild(a);
}
```

## 手写节流 throttle、防抖 debounce

## 手写深拷贝

```js
/**
 * 1. 注意判断值类型和引用类型
 * 2. 注意判断是数组还是对象
 * 3. 递归
 */

function deepClone(targetObj = {}) {
  // 检查targetObj 是null，或者不是对象和数组，直接返回结果
  if (typeof targetObj !== 'object' || targetObj == null) {
    return targetObj;
  }

  let result;
  // 判断是数组还是对象，对 result 初始化
  if (targetObj instanceof Array) {
    resule = [];
  } else {
    result = {};
  }

  for (let key in targetObj) {
    // 保证 key 不是原型的属性
    if (targetObj.hasOwnProperty(key)) {
      // 递归
      result[key] = deepClone(targetObj[key]);
    }
  }

  return result;
}

// test deepClone
const obj1 = {
  name: 'zhangSan',
  age: 23,
  isMan: true,
  address: {
    city: 'beijing',
    road: 'tiangu 8th',
    post: [710065, 710000],
  },
  family: ['father', 'mather', 'sister'],
};
const obj2 = deepClone(obj1);
obj1.address.city = "xi'an";
console.table(obj2);
```

## 手写 bind 函数

```js
Function.prototype.bind1 = function () {
  // 将参数拆解为数组
  const args = Array.prototype.slice.call(arguments);

  // 获取 this（数组第一项）
  const t = args.shift();

  // fn1.bind(...) 中的 fn1
  const self = this;

  // 返回一个函数
  return function () {
    return self.apply(t, args);
  };
};

function fn1(a, b, c) {
  console.log('this', this);
  console.log(a, b, c);
  return 'this is fn1';
}

const fn2 = fn1.bind1({ x: 100 }, 10, 20, 30);
const res = fn2();
console.log(res);
```

## 手写异步加载图片

```js
function imgLoader(src) {
  return new Promise((resolve, reject) => {
    const img = document.createElement('img');
    img.onload = function () {
      resolve(img);
    };
    img.onerror = function () {
      const errorMsg = new Error('img is load failed' + src);
      reject(errorMsg);
    };
    img.src = src;
  });
}

const url = 'https://xxx.com/xxx';
imgLoader(url)
  .then((img) => {
    console.log(img.width);
    return img;
  })
  .then((img) => {
    console.log(img.height);
  })
  .catch((e) => {
    console.error(e);
  });
```
